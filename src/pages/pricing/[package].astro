---
import { Image } from "astro:assets";
import PricingPageFunnelLayout from "../../layouts/PricingPageFunnelLayout.astro";
import { pricingPackages } from "../../data/pricingPackages.js";
import CaseStudiesVideo from "../../components/CaseStudiesVideo.astro"; // Import homepage data for case studies
import homePage from "../../data/homePage"; // Import homepage data for case studies

import {
  generateKeywords,
  AVIATION_KEYWORDS,
  TARGET_LOCATIONS,
} from "../../utils/seo";

// Import all images from assets
const images = import.meta.glob('/src/assets/**/*.{jpeg,jpg,png,gif,webp}', { eager: true });

// Helper function to get image by path
const getImage = (path) => {
  const image = images[path];
  return image?.default || path;
};

export async function getStaticPaths() {
  return Object.keys(pricingPackages).map((packageKey) => ({
    params: { package: packageKey },
  }));
}

const { data } = homePage; // Use homepage data for case studies
const { package: packageSlug } = Astro.params;
const packageData = pricingPackages[packageSlug];

if (!packageData) {
  return Astro.redirect('/404');
}

// SEO keyword generation for package page
const enhancedKeywords = generateKeywords(
  [
    ...AVIATION_KEYWORDS.primary.slice(0, 3),
    `${packageData.name.toLowerCase()} marketing`,
    "flight school marketing package",
    "aviation marketing pricing",
    "pilot training marketing",
  ],
  TARGET_LOCATIONS.slice(0, 6),
  [
    "flight school marketing program",
    "aviation marketing services",
    "pilot school marketing package",
    "flight training marketing solution",
  ]
);

const metaTitle = `${packageData.name} Marketing Program | Right Rudder Marketing`;
const metaDescription = `${packageData.programIntro.description.substring(0, 150)}... Perfect for flight schools with ${packageData.aircraft} aircraft targeting ${packageData.targetRevenue} revenue.`;

// Content for GenericCTA component
const ctaContent = {
  imagePath: "/src/assets/avel-chuklanov-QbTBCUJLqKY-unsplash(1).jpg", //Why we using generic image file name.. Not best practice...
  imageAlt: "Right Rudder Marketing team on the runway",
  headerH1: `<span class="text-primary">Ready to start your</br> ${packageData.name} program?</span>`,
  paragraph: `The ${packageData.name} program is specifically designed for flight schools with ${packageData.aircraft} aircraft. Let's discuss how this comprehensive marketing solution can help you reach ${packageData.targetRevenue} in annual revenue.`,
  buttons: [
    {
      name: "Download Free Guide",
      link: "/resources/flight-school-handbook",
      primary: false,
    },
    {
      name: "Schedule Consultation",
      link: "/schedule-call",
      primary: true,
    },
  ],
};
---

<PricingPageFunnelLayout
  siteTitle={metaTitle}
  siteDescription={metaDescription}
  keywords={enhancedKeywords}
  content={ctaContent}
>
  <!-- Hero Section with Program Image -->
  <section class="lg:h-screen-1/2 bg-gradient-to-r from-primary-dark to-primary-800 py-16 text-white relative">
    <div class="absolute inset-0 opacity-20">
      <Image
        src={getImage(packageData.heroImage)}
        alt={packageData.heroImageAlt}
        class="w-full h-full object-cover"
        loading="eager"
        width={1200}
        height={600}
        format="webp"
      />
    </div>
    <div class="max-w-6xl mx-auto px-4 relative z-10 grid place-items-center h-full">
      <div class="text-center">
        <h1 class="text-4xl md:text-5xl font-bold mb-4">
          {packageData.name} Program
        </h1>
        <h2 class="text-lg max-w-3xl mx-auto opacity-80">
          For flight schools with {packageData.aircraft} aircraft targeting {packageData.targetRevenue} annual revenue
        </h2>
      </div>
    </div>
  </section>

  <!-- Program Introduction -->
  <section class="py-16 bg-white">
    <div class="max-w-6xl mx-auto px-4">
      <div class="text-center mb-12">
        <h2 class="text-3xl md:text-4xl font-bold text-primary-dark mb-6">
          {packageData.name} Program
        </h2>
        <p class="text-xl text-primary-600 font-semibold mb-8">
          {packageData.programIntro.subtitle}
        </p>
      </div>
      
      <div class="grid md:grid-cols-2 gap-12 mb-16">
        <div>
          <p class="text-lg text-gray-700 mb-6 leading-relaxed">
            {packageData.programIntro.description}
          </p>
          <p class="text-lg text-gray-700 mb-6 leading-relaxed">
            {packageData.programIntro.partnership}
          </p>
        </div>
        <div>
          <p class="text-lg text-gray-700 mb-6 leading-relaxed">
            {packageData.programIntro.expertise}
          </p>
          <p class="text-lg text-gray-700 leading-relaxed">
            {packageData.programIntro.commitment}
          </p>
        </div>
      </div>

      <!-- Flight School Marketing System -->
      <div class="text-center mb-16">
        <h2 class="text-3xl font-bold text-primary-dark mb-4">What We Will Implement For Your Flight School</h2>

        <div class="max-w-lg mx-auto py-10">
          <Image
            src={getImage("/src/assets/fsms.webp")}
            alt="Flight School Marketing System diagram"
            class="w-full"
            loading="lazy"
            width={1200}
            height={800}
            format="webp"
          />
        </div>

        
        <p class="text-lg text-gray-700 mb-6 font-semibold">
          This is the Flight School Marketing System
        </p>

        <div class="max-w-3xl mx-auto mb-8 text-left">
          <p class="text-gray-700 mb-4 leading-relaxed">
        It's a multi-faceted approach.  There is no silver bullet in marketing. We combine consistent execution across several channels to drive sustainable growth:
          </p>
          <ul class="list-inside list-disc text-gray-700 space-y-2">
        <li>Website ‚Äî a conversion-focused, mobile-first site</li>
        <li>SEO ‚Äî local & technical optimization to rank your school</li>
        <li>PPC ‚Äî targeted ad campaigns to drive qualified leads</li>
        <li>Reputation Management ‚Äî reviews & local trust-building</li>
        <li>Sales Process ‚Äî lead qualification, nurture, and enrollment workflows</li>
          </ul>
        </div>

        <h3 class="text-gray-600 mt-6 max-w-3xl mx-auto leading-relaxed font-bold text-xl">
          Sustainable growth comes from the coordinated effort of these components.  We implement and optimize each area to work together, not in isolation.
        </h3>
      </div>
    </div>
  </section>

  <!-- Expectations Section -->
  <section class="py-16 bg-gray-50">
    <div class="max-w-6xl mx-auto px-4">
      <h2 class="text-3xl font-bold text-center text-primary-dark mb-12">
        Expectations
      </h2>
      <div class="text-center mb-8">
        <h3 class="text-2xl font-bold text-primary-600 mb-6">
          {packageData.expectations.title}
        </h3>
      </div>
      
      <div class="grid md:grid-cols-2 gap-8 mb-12">
        <div class="space-y-6">
          <p class="text-gray-700 leading-relaxed">
            {packageData.expectations.consulting}
          </p>
          <p class="text-gray-700 leading-relaxed">
            {packageData.expectations.program}
          </p>
        </div>
        <div class="space-y-6">
          <p class="text-gray-700 leading-relaxed">
            {packageData.expectations.partnership}
          </p>
          <p class="text-gray-700 leading-relaxed">
            {packageData.expectations.process}
          </p>
        </div>
      </div>

      <div class="bg-white rounded-lg shadow-md p-8 mb-8">
        <h4 class="text-xl font-bold text-primary-dark mb-4">
          {packageData.name} Program Positioning
        </h4>
        <p class="text-gray-700 leading-relaxed mb-4">
          {packageData.expectations.positioning}
        </p>
        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
          <p class="text-gray-800 font-medium">
            {packageData.expectations.growth}
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Pricing Overview -->
  <section class="py-12 bg-white">
    <div class="max-w-4xl mx-auto px-4">
      <h2 class="text-3xl font-bold text-center text-primary-dark mb-12">Investment Overview</h2>
      <div class="bg-gradient-to-r from-primary-50 to-accent-50 rounded-lg shadow-lg p-8 mb-8">
        <div class="grid md:grid-cols-3 gap-6 text-center">
          <div class="border-r border-gray-200 pr-6">
            <h3 class="text-lg font-semibold text-gray-700 mb-2">Monthly Total</h3>
            <p class="text-3xl font-bold text-primary-dark">{packageData.totalMonthly}</p>
            <p class="text-sm text-gray-600 mt-2">
              Service Fee: {packageData.monthlyFee}<br/>
              Google Ads: {packageData.googleAdBudget}<br/>
              {packageData.otherPlatformBudget !== "$0" && `Other Platforms: ${packageData.otherPlatformBudget}`}
            </p>
          </div>
          <div class="border-r border-gray-200 pr-6">
            <h3 class="text-lg font-semibold text-gray-700 mb-2">Annual Investment</h3>
            <p class="text-3xl font-bold text-accent">{packageData.totalAnnual}</p>
            <p class="text-sm text-gray-600 mt-2">
              Includes onboarding fee
            </p>
          </div>
          <div>
            <h3 class="text-lg font-semibold text-gray-700 mb-2">Onboarding</h3>
            <p class="text-3xl font-bold text-primary-dark">{packageData.onboardingFee}</p>
            <p class="text-sm text-gray-600 mt-2">
              One time setup fee
            </p>
          </div>
        </div>
      </div>

      <!-- Add-ons -->
      <div class="grid md:grid-cols-2 gap-6 mb-8">
        <div class="bg-white rounded-lg shadow-md p-6 border">
          <h3 class="text-xl font-semibold text-primary-dark mb-4">üìç Additional Locations</h3>
          <p class="text-2xl font-bold text-accent mb-2">{packageData.additionalLocations}</p>
          <p class="text-gray-600">Perfect for multi-location flight schools expanding to new airports. Each additional location gets full local marketing optimization.</p>
        </div>
        <div class="bg-white rounded-lg shadow-md p-6 border">
          <h3 class="text-xl font-semibold text-primary-dark mb-4">üè¢ Additional Businesses</h3>
          <p class="text-2xl font-bold text-accent mb-2">{packageData.additionalCompanies}</p>
          <p class="text-gray-600">Expand coverage to related aviation businesses under the same ownership (for example helicopter tours and maintenance shops).</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Service Sections -->
  <section class="py-16 bg-gray-50">
    <div class="max-w-6xl mx-auto px-4">
      <!-- Onboarding Section -->
      <div class="mb-16">
        <h2 class="text-3xl font-bold text-center text-primary-dark mb-4">
          {packageData.onboarding.icon} {packageData.onboarding.title}
        </h2>
        <div class="grid md:grid-cols-1 lg:grid-cols-3 gap-8">
          {packageData.onboarding.services.map((service) => (
            <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
              <Image
                src={getImage(service.image)}
                alt={service.imageAlt}
                class="w-full h-48 object-cover rounded-lg mb-4"
                loading="lazy"
                width={400}
                height={300}
                format="webp"
              />
              <h3 class="text-xl font-semibold text-primary-dark mb-3">‚úì {service.name}</h3>
              <p class="text-gray-700 leading-relaxed">{service.description}</p>
            </div>
          ))}
        </div>
      </div>

      <!-- Additional Growth Section -->
      <div class="mb-16">
        <h2 class="text-3xl font-bold text-center text-primary-dark mb-4">
          {packageData.additionalGrowth.icon} {packageData.additionalGrowth.title}
        </h2>
        <div class="grid md:grid-cols-2 gap-8">
          {packageData.additionalGrowth.services.map((service) => (
            <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
              <Image
                src={getImage(service.image)}
                alt={service.imageAlt}
                class="w-full h-48 object-cover rounded-lg mb-4"
                loading="lazy"
                width={400}
                height={300}
                format="webp"
              />
              <h3 class="text-xl font-semibold text-primary-dark mb-3">‚úì {service.name}</h3>
              <p class="text-gray-700 leading-relaxed">{service.description}</p>
            </div>
          ))}
        </div>
      </div>

      <!-- New Customer Acquisition Section -->
      <div class="mb-16">
        <h2 class="text-3xl font-bold text-center text-primary-dark mb-4">
          {packageData.newCustomerAcquisition.icon} {packageData.newCustomerAcquisition.title}
        </h2>
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {packageData.newCustomerAcquisition.services.map((service) => (
            <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
              <Image
                src={getImage(service.image)}
                alt={service.imageAlt}
                class="w-full h-48 object-cover rounded-lg mb-4"
                loading="lazy"
                width={400}
                height={300}
                format="webp"
              />
              <h3 class="text-xl font-semibold text-primary-dark mb-3">‚úì {service.name}</h3>
              <p class="text-gray-700 leading-relaxed">{service.description}</p>
            </div>
          ))}
        </div>
      </div>
    </div>
  </section>

  <!-- What's Included vs Additional Services -->
  <section class="py-16 bg-white">
    <div class="max-w-6xl mx-auto px-4">
      <div class="grid md:grid-cols-2 gap-12">
        <!-- What's Actually Included -->
        <div>
          <h2 class="text-2xl font-bold text-green-600 mb-6">‚úÖ What's Included</h2>
          <div class="bg-green-50 rounded-lg p-6">
            <p class="text-sm text-green-700 mb-4 font-medium">Included in your {packageData.totalMonthly}/month investment:</p>
            <div class="space-y-3">
              {packageData.includedServices.map((service) => (
                <div class="flex items-start">
                  <div class="flex-shrink-0 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-3 mt-0.5">
                    <span class="text-white font-bold text-sm">‚úì</span>
                  </div>
                  <p class="text-gray-700">{service}</p>
                </div>
              ))}
            </div>
          </div>
        </div>

        <!-- Additional Services -->
        <div>
          <h2 class="text-2xl font-bold text-blue-600 mb-6">üí∞ Additional Services</h2>
          <div class="bg-blue-50 rounded-lg p-6 mb-6">
            <p class="text-sm text-blue-700 mb-4 font-medium">Available as paid add-ons:</p>
            <div class="space-y-4">
              {packageData.additionalServices.map((service) => (
                <div class="border-l-4 border-blue-400 pl-4">
                  <div class="flex justify-between items-start mb-2">
                    <h3 class="font-semibold text-gray-800">{service.name}</h3>
                    <span class="text-blue-600 font-bold">{service.price}</span>
                  </div>
                  <p class="text-gray-600 text-sm">{service.description}</p>
                </div>
              ))}
            </div>
          </div>

          {/* Not Available Section */}
          {packageData.notAvailable && packageData.notAvailable.length > 0 && (
            <div>
              <h3 class="text-lg font-bold text-gray-600 mb-4">‚ö†Ô∏è Not Available at This Tier</h3>
              <div class="bg-gray-50 rounded-lg p-4">
                <div class="space-y-2">
                  {packageData.notAvailable.map((service) => (
                    <div class="flex items-start">
                      <div class="flex-shrink-0 w-6 h-6 bg-gray-400 rounded-full flex items-center justify-center mr-3 mt-0.5">
                        <span class="text-white font-bold text-sm">‚úó</span>
                      </div>
                      <p class="text-gray-600 text-sm">{service}</p>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  </section>

  <!-- Video Gallery -->
  {packageData.videos && packageData.videos.length > 1 && (
    <section class="py-16 bg-gray-50">
      <div class="max-w-6xl mx-auto px-4">
        <h2 class="text-3xl font-bold text-center text-primary-dark mb-12">Program Videos</h2>
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {packageData.videos.slice(1).map((video) => (
            <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
              <Image
                src={getImage(video.placeholder)}
                alt={video.description}
                class="w-full h-48 object-cover cursor-pointer"
                loading="lazy"
                width={600}
                height={400}
                format="webp"
              />
              <div class="p-4">
                <h3 class="font-semibold text-gray-800 mb-2">{video.title}</h3>
                <p class="text-gray-600 text-sm">{video.description}</p>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- FAQs -->
  <section class="py-16 bg-white">
    <div class="max-w-4xl mx-auto px-4">
      <h2 class="text-3xl font-bold text-center text-primary-dark mb-12">Frequently Asked Questions</h2>
      <div class="space-y-6">
        {packageData.faqs.map((faq, index) => (
          <div class="bg-gray-50 rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
            <h3 class="text-lg font-semibold text-primary-dark mb-3">
              {faq.question}
            </h3>
            <p class="text-gray-700 leading-relaxed">
              {faq.answer}
            </p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-16 bg-primary-dark text-white">
    <div class="max-w-4xl mx-auto px-4 text-center flex flex-col items-center">
      <h2 class="text-3xl font-bold mb-6">Ready to Take Your Flight School to the Next Level?</h2>
      <p class="text-xl mb-8 opacity-90">
        Let's discuss how the Right Rudder Marketing can accelerate your growth and help you reach {packageData.targetRevenue} in annual revenue.
      </p>
      <div class="flex flex-col sm:flex-row justify-center gap-4">
        <a 
          href="/schedule-call" 
          class="inline-block bg-accent hover:bg-accent-600 text-white font-bold py-4 px-8 rounded-lg transition duration-300 text-lg"
        >
          Schedule Your Consultation
        </a>
        <a 
          href="/contact" 
          class="inline-block border-2 border-white hover:bg-white hover:text-primary-dark text-white font-bold py-4 px-8 rounded-lg transition duration-300 text-lg"
        >
          Get More Information
        </a>
      </div>
      <p class="mt-6 text-sm opacity-75">
        üìû Call us directly: (314) 804-1200<br/>
        ‚úàÔ∏è Pilot-owned marketing agency specializing in flight schools
      </p>

      <p class="mt-6 text-sm max-w-xl opacity-75">
        NOTE: Actual results may vary based on individual flight school circumstances and market conditions. The pricing and services described on this page are an estimate and may change based on your specific needs and goals.  Talk to a Right Rudder Marketing representative for details about pricing.
      </p>
    </div>
  </section>

  <CaseStudiesVideo
    upperHeading={data.caseStudies.upperHeading}
    heading={data.caseStudies.heading}
    cases={data.caseStudies.cases}
  />
</PricingPageFunnelLayout>