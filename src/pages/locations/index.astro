---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import HeaderScreen from "../../components/HeaderScreen.astro";

// Get all locations and sort by priority
const locations = await getCollection("locations");
const sortedLocations = locations.sort(
  (a, b) => (a.data.priority || 999) - (b.data.priority || 999)
);

const header = {
  stars: true,
  imagePath: "/src/assets/flying-over-right-rudder-marketing.jpeg",
  imageAlt:
    "fly over Right Rudder Marketing - Digital Marketing Agency for Flight Schools",
  headerH1: `Double your student</br><span class="text-accent-300">enrollments in 6 months</span>`,
  paragraph:
    "Enroll more pilots in your flight school and leave a lasting impact to the next generation of future aviators while saving time and increasing profits and revenue.",
  buttons: [
    {
      name: "Our Marketing System",
      link: "/marketing-system",
      primary: false,
    },
    {
      name: "Free Marketing Analysis",
      link: "/schedule-call",
      primary: false,
    },
  ],
};

// Group locations by type
const states = sortedLocations.filter((loc) => loc.data.type === "state");
const cities = sortedLocations.filter((loc) => loc.data.type === "city");

const pageTitle = "Flight School Marketing Locations | Right Rudder Marketing";
const pageDescription =
  "Professional flight school marketing services across the United States. Find expert aviation marketing solutions in your state or city to grow your flight school.";
---

<BaseLayout
  siteTitle={pageTitle}
  siteDescription={pageDescription}
  keywords="flight school marketing locations, aviation marketing services, pilot training marketing, flight school SEO, aviation advertising"
>
  <!-- HEADER -->
  <HeaderScreen content={header} />
  <Fragment slot="head">
    <!-- Structured data for service areas -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Service",
        "name": "Flight School Marketing Services",
        "description": "Professional marketing services for flight schools and aviation academies across the United States",
        "provider": {
          "@type": "Organization",
          "name": "Right Rudder Marketing",
          "url": "https://rightruddermarketing.com"
        },
        "serviceType": "Flight School Marketing",
        "areaServed": {
          "@type": "Country",
          "name": "United States",
          "addressCountry": "US"
        }
      }
    </script>

    <!-- Open Graph tags -->
    <meta property="og:title" content={pageTitle} />
    <meta property="og:description" content={pageDescription} />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://rightruddermarketing.com/locations"
    />

    <!-- Canonical URL -->
    <link rel="canonical" href="https://rightruddermarketing.com/locations" />
  </Fragment>

  <!-- Hero Section -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-12 pt-20">
    <div class="text-center mb-12">
      <h2 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">
        Flight School Marketing Across America
      </h2>
      <p class="text-xl text-gray-600 max-w-3xl mx-auto">
        Professional aviation marketing services nationwide. Find expert flight
        school marketing solutions in your state or city to increase enrollment
        and grow your aviation academy.
      </p>
    </div>
    <!-- Overview Stats -->
    <div class="bg-blue-50 rounded-lg p-6 mb-12">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
        <div>
          <div class="text-3xl font-bold text-blue-600">
            {sortedLocations.length}
          </div>
          <div class="text-sm text-gray-600">Markets Served</div>
        </div>
        <div>
          <div class="text-3xl font-bold text-blue-600">
            {
              sortedLocations.reduce(
                (sum, loc) => sum + (loc.data.flightSchoolCount || 0),
                0
              )
            }
          </div>
          <div class="text-sm text-gray-600">Flight Schools Served</div>
        </div>
        <div>
          <div class="text-3xl font-bold text-blue-600">50+</div>
          <div class="text-sm text-gray-600">States Covered</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Top Markets -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-12 py-12">
    <h2 class="text-3xl font-bold text-gray-900 mb-8">Top Aviation Markets</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {
        cities.slice(0, 6).map((city) => (
          <a
            href={`/locations/${city.slug}`}
            class="block bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow border border-gray-200 hover:border-blue-300 p-6"
          >
            <h3 class="text-xl font-semibold text-gray-900 mb-2">
              {city.data.city}, {city.data.stateCode}
            </h3>
            <p class="text-gray-600 mb-4 text-sm line-clamp-2">
              {city.data.description}
            </p>
            <div class="flex justify-between items-center text-sm text-gray-500">
              <span>{city.data.flightSchoolCount} Schools</span>
              <span class="capitalize bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs">
                {city.data.competitiveLevel} Competition
              </span>
            </div>
          </a>
        ))
      }
    </div>
  </section>

  <!-- All States -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-12 py-12">
    <h2 class="text-3xl font-bold text-gray-900 mb-8">States We Serve</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {
        states.map((state) => (
          <a
            href={`/locations/${state.slug}`}
            class="block bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow border border-gray-200 hover:border-blue-300 p-4"
          >
            <div class="flex justify-between items-start">
              <div>
                <h3 class="text-lg font-semibold text-gray-900">
                  {state.data.state}
                </h3>
                <p class="text-sm text-gray-600 mt-1">
                  {state.data.flightSchoolCount} Flight Schools
                </p>
              </div>
              <span class="text-xs font-medium text-blue-600 bg-blue-50 px-2 py-1 rounded">
                {state.data.stateCode}
              </span>
            </div>
            <div class="mt-3">
              <div class="flex flex-wrap gap-1">
                {state.data.majorAirports.slice(0, 3).map((airport) => (
                  <span class="text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded font-mono">
                    {airport}
                  </span>
                ))}
                {state.data.majorAirports.length > 3 && (
                  <span class="text-xs text-gray-500">
                    +{state.data.majorAirports.length - 3} more
                  </span>
                )}
              </div>
            </div>
          </a>
        ))
      }
    </div>
  </section>

  <!-- All Cities -->
  {
    cities.length > 6 && (
      <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-12 py-12 mb-24">
        <h2 class="text-3xl font-bold text-gray-900 mb-8">Cities We Serve</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          {cities.slice(6).map((city) => (
            <a
              href={`/locations/${city.slug}`}
              class="block bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow border border-gray-200 hover:border-blue-300 p-4"
            >
              <h3 class="text-lg font-semibold text-gray-900">
                {city.data.city}
              </h3>
              <p class="text-sm text-gray-600">{city.data.state}</p>
              <div class="mt-2 text-xs text-gray-500">
                {city.data.flightSchoolCount} Schools â€¢{" "}
                {city.data.competitiveLevel} Competition
              </div>
            </a>
          ))}
        </div>
      </section>
    )
  }

  <!-- Services Overview -->
  <!--  <section
    class="bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg p-8 text-white"
  >
    <div class="text-center">
      <h2 class="text-3xl font-bold mb-4">
        Flight School Marketing Services Nationwide
      </h2>
      <p class="text-xl mb-6 max-w-2xl mx-auto">
        Whether you're in a major aviation hub or a smaller market, we provide
        comprehensive digital marketing solutions tailored to your local market
        conditions.
      </p>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8 mb-8">
        <div class="text-center">
          <div class="text-2xl mb-2">ðŸŽ¯</div>
          <h3 class="font-semibold mb-2">Local SEO</h3>
          <p class="text-sm opacity-90">
            Dominate local search results in your area
          </p>
        </div>
        <div class="text-center">
          <div class="text-2xl mb-2">ðŸ“±</div>
          <h3 class="font-semibold mb-2">PPC Advertising</h3>
          <p class="text-sm opacity-90">Targeted ads for your local market</p>
        </div>
        <div class="text-center">
          <div class="text-2xl mb-2">ðŸ“Š</div>
          <h3 class="font-semibold mb-2">Analytics & Reporting</h3>
          <p class="text-sm opacity-90">Track your market performance</p>
        </div>
      </div>

      <div
        class="space-y-4 sm:space-y-0 sm:space-x-4 sm:flex sm:justify-center"
      >
        <a
          href="/contact"
          class="inline-block bg-white text-blue-600 font-semibold px-8 py-3 rounded-lg hover:bg-gray-100 transition-colors"
        >
          Get Free Market Analysis
        </a>
        <a
          href="/case-studies"
          class="inline-block border-2 border-white text-white font-semibold px-8 py-3 rounded-lg hover:bg-white hover:text-blue-600 transition-colors"
        >
          View Success Stories
        </a>
      </div>
    </div>
  </section> -->
</BaseLayout>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
