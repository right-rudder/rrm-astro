# Performance Optimization Configuration for Netlify

[build]
  publish = "dist"
  command = "npm run build"
  
[build.processing.html]
  pretty_urls = false

# Environment variables for better builds
[build.environment]
  NODE_VERSION = "18"
  NPM_FLAGS = "--no-optional"

# Security and performance headers
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Permissions-Policy = "camera=(), microphone=(), geolocation=()"

# Cache static assets aggressively
[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Cache images for better performance
[[headers]]
  for = "*.{jpg,jpeg,png,gif,webp,avif,svg,ico}"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Cache fonts
[[headers]]
  for = "*.{woff,woff2,ttf,otf,eot}"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# HTML files - shorter cache for content updates
[[headers]]
  for = "*.html"
  [headers.values]
    Cache-Control = "public, max-age=3600, must-revalidate"

# Preconnect headers for critical performance
[[headers]]
  for = "/"
  [headers.values]
    Link = '''
      <https://fonts.googleapis.com>; rel=preconnect; crossorigin,
      <https://fonts.gstatic.com>; rel=preconnect; crossorigin,
      <https://www.google-analytics.com>; rel=preconnect; crossorigin,
      <https://www.googletagmanager.com>; rel=preconnect; crossorigin
    '''

# Enhanced compression
[[headers]]
  for = "*.{js,css,html,txt,xml,json,svg}"
  [headers.values]
    Content-Encoding = "gzip"

# SEO-friendly 301 redirects for old URLs
[[redirects]]
  from = "/contact-us"
  to = "/contact"
  status = 301

[[redirects]]
  from = "/our-team"
  to = "/about/who-we-are"
  status = 301

[[redirects]]
  from = "/flight-crew"
  to = "/about/who-we-are"
  status = 301

[[redirects]]
  from = "/mission-and-vision"
  to = "/about/who-we-are"
  status = 301

[[redirects]]
  from = "/core-values"
  to = "/about/who-we-are"
  status = 301

[[redirects]]
  from = "/notams"
  to = "/blog"
  status = 301

[[redirects]]
  from = "/notams/*"
  to = "/blog/:splat"
  status = 301

[[redirects]]
  from = "/flight-school-google-my-business"
  to = "/resources/gmb"
  status = 301

[[redirects]]
  from = "/keywords"
  to = "/resources/flight-school-keywords"
  status = 301

[[redirects]]
  from = "/flight-school-hot-aviation-keyword-list"
  to = "/resources/flight-school-keywords"
  status = 301

[[redirects]]
  from = "/flight-school-marketing-checklist"
  to = "/resources/marketing-checklist"
  status = 301

[[redirects]]
  from = "/partners-affiliates-sponsors"
  to = "/about/partners-affiliates"
  status = 301

[[redirects]]
  from = "/investors"
  to = "/about/investors"
  status = 301

[[redirects]]
  from = "/careers"
  to = "/about/careers"
  status = 301

# Handle search engine optimization
[[redirects]]
  from = "/search-engine-optimization"
  to = "/flight-school-seo"
  status = 301

# 404 error handling
[[redirects]]
  from = "/*"
  to = "/404"
  status = 404